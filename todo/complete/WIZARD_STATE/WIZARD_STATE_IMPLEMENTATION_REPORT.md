# –û—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –≤–∏–∑–∞—Ä–¥–∞

**–î–∞—Ç–∞:** 2026-01-30  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-09  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å hasChanges)

---

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –≤–∏–∑–∞—Ä–¥–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ `WIZARD_STATE_MANAGEMENT_SPEC.md`. –í–∏–∑–∞—Ä–¥ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–§–∞–π–ª:** `ui/wizard/models/wizard_state_file.go`

- ‚úÖ `WizardStateFile` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ `ConfigParam` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (route.final, experimental.clash_api.secret)
- ‚úÖ `PersistedRuleState` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è RuleState —Å –ø–æ–ª–µ–º `type`
- ‚úÖ `PersistedTemplateSelectableRule` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è TemplateSelectableRule
- ‚úÖ `WizardStateMetadata` ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Å–ø–∏—Å–∫–∞
- ‚úÖ `ValidateStateID()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É `RuleState` –∏ `PersistedRuleState`
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ (RFC3339)

### 2. –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π (StateStore)

**–§–∞–π–ª:** `ui/wizard/business/state_store.go`

- ‚úÖ `NewStateStore()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ StateStore
- ‚úÖ `SaveWizardState()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º ID
- ‚úÖ `SaveCurrentState()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `state.json`
- ‚úÖ `LoadWizardState()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ ID
- ‚úÖ `LoadCurrentState()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ `state.json`
- ‚úÖ `ListWizardStates()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ `DeleteWizardState()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- ‚úÖ `StateExists()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `bin/wizard_states/`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 256 KB)

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Presenter

**–§–∞–π–ª:** `ui/wizard/presentation/presenter_state.go`

- ‚úÖ `CreateStateFromModel()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ `WizardStateFile` –∏–∑ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
- ‚úÖ `SaveCurrentState()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `state.json`
- ‚úÖ `SaveStateAs()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥ –Ω–æ–≤—ã–º ID —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
- ‚úÖ `LoadState()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –º–æ–¥–µ–ª—å (9-—à–∞–≥–æ–≤–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
- ‚úÖ `HasUnsavedChanges()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ `MarkAsChanged()` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ `MarkAsSaved()` ‚Äî —Å–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ `extractSourceURLsFromParserConfig()` ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ SourceURLs –∏–∑ ParserConfig
- ‚úÖ `restoreConfigParams()` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–æ–ª–µ `hasChanges` –≤ `WizardPresenter`
- ‚úÖ –§–ª–∞–≥ `UpdatingOutboundOptions` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `ui/wizard/presentation/presenter_sync.go`

- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `SyncGUIToModel()` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `hasChanges` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### 4. UI –î–∏–∞–ª–æ–≥–∏

**–§–∞–π–ª:** `ui/wizard/dialogs/load_state_dialog.go`

- ‚úÖ `ShowLoadStateDialog()` ‚Äî –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –í—ã–¥–µ–ª–µ–Ω–∏–µ `state.json` –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ"
- ‚úÖ –ö–Ω–æ–ø–∫–∏: "–ó–∞–≥—Ä—É–∑–∏—Ç—å", "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ", "–û—Ç–º–µ–Ω–∞"
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (state.json –ø–µ—Ä–≤—ã–º, –∑–∞—Ç–µ–º –ø–æ –¥–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)

**–§–∞–π–ª:** `ui/wizard/dialogs/save_state_dialog.go`

- ‚úÖ `ShowSaveStateDialog()` ‚Äî –¥–∏–∞–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ü–æ–ª–µ –≤–≤–æ–¥–∞ ID —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –ü–æ–ª–µ –≤–≤–æ–¥–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º ID
- ‚úÖ –ö–Ω–æ–ø–∫–∏: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "–û—Ç–º–µ–Ω–∞"

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≤–∏–∑–∞—Ä–¥

**–§–∞–π–ª:** `ui/wizard/wizard.go`

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `state.json` –∏ –¥—Ä—É–≥–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
- ‚úÖ –ü–æ–∫–∞–∑ –¥–∏–∞–ª–æ–≥–∞ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –†–µ–∂–∏–º "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ" ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏: "Read", "Save", "Save As"
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –≤–∏–∑–∞—Ä–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
  - `loadConfigFromFile()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ config.json/—à–∞–±–ª–æ–Ω–∞
  - `loadStateFromFile()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞
  - `initializeWizardContent()` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–∏–∑–∞—Ä–¥–∞
  - `handleReadButton()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "Read"
  - `handleSaveStateButton()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "Save"
  - `handleSaveAsButton()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "Save As"
  - `handleCloseButton()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–§–∞–π–ª:** `ui/wizard/presentation/gui_state.go`

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏:
  - `ReadButton`
  - `SaveStateButton`
  - `SaveAsButton`

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `ui/wizard/models/wizard_state_file.go` (279 —Å—Ç—Ä–æ–∫)
   - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

2. `ui/wizard/business/state_store.go` (310 —Å—Ç—Ä–æ–∫)
   - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π
   - –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π

3. `ui/wizard/presentation/presenter_state.go` (296 —Å—Ç—Ä–æ–∫)
   - –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –≤ Presenter
   - –õ–æ–≥–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è

4. `ui/wizard/dialogs/load_state_dialog.go` (155 —Å—Ç—Ä–æ–∫)
   - –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏

5. `ui/wizard/dialogs/save_state_dialog.go` (120 —Å—Ç—Ä–æ–∫)
   - –î–∏–∞–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥ –Ω–æ–≤—ã–º ID

---

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `ui/wizard/presentation/gui_state.go`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

2. `ui/wizard/presentation/presenter_sync.go`
   - –û–±–Ω–æ–≤–ª—ë–Ω `SyncGUIToModel()` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. `ui/wizard/wizard.go`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∏–∑–∞—Ä–¥–∞
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

4. `ui/wizard/presentation/presenter_methods.go`
   - –î–æ–±–∞–≤–ª–µ–Ω —Å–±—Ä–æ—Å `hasChanges` –≤ `RefreshOutboundOptions()` –ø–æ—Å–ª–µ –≤—Å–µ—Ö `SetSelected()` –≤—ã–∑–æ–≤–æ–≤
   - –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

5. `ui/wizard/tabs/rules_tab.go`
   - –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `UpdatingOutboundOptions = true` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤–∏–¥–∂–µ—Ç–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `!UpdatingOutboundOptions` –≤ callback'–∞—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã `MarkAsChanged()` –≤ callback'–∞—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª

---

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é

- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `state.json` –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- [x] –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
- [x] –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
- [x] –ö–Ω–æ–ø–∫–∏ "Read", "Save", "Save As"
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
- [x] –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [x] –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- [x] –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- [x] –†–µ–∂–∏–º "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ"
- [x] 9-—à–∞–≥–æ–≤–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è `WizardModel`
- [x] –•—Ä–∞–Ω–µ–Ω–∏–µ `parser_config` –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ `@ParserConfig`
- [x] –•—Ä–∞–Ω–µ–Ω–∏–µ `config_params` –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—è `type` –¥–ª—è –ø—Ä–∞–≤–∏–ª (System, IP Addresses, Domains/URLs, Processes, Custom JSON)
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `bin/wizard_states/`
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1)

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ / –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `experimental.clash_api.secret` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ ‚Äî –ª–æ–≥–∏–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `SaveConfigWithBackup`, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### üìù –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏)

- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (—Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π —á–µ—Ä–µ–∑ UI (–º–µ—Ç–æ–¥ `DeleteWizardState` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

## üîç –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è WizardModel

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏):

1. ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞ (TemplateData) ‚Äî —à–∞–±–ª–æ–Ω —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
2. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `parser_config` ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
3. ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `SourceURLs` ‚Äî –∏–∑ `parser_config.ParserConfig.proxies`
4. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `config_params` ‚Äî –º–∞–ø–ø–∏–Ω–≥ `route.final` ‚Üí `SelectedFinalOutbound`
5. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `TemplateSectionSelections` ‚Äî –≤—Å–µ —Å–µ–∫—Ü–∏–∏ = `true`
6. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `SelectableRuleStates` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
7. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `CustomRules` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
8. ‚úÖ –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `PreviewNeedsParse = true`
9. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è GUI ‚Äî –≤—ã–∑–æ–≤ `SyncModelToGUI()`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ Fallback –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚úÖ –§–ª–∞–≥ `hasChanges` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `SyncGUIToModel()` (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
- ‚úÖ –§–ª–∞–≥ `hasChanges` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª —á–µ—Ä–µ–∑ callback'–∏ –≤–∏–¥–∂–µ—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `!UpdatingOutboundOptions`)
- ‚úÖ –§–ª–∞–≥ `UpdatingOutboundOptions` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É `hasChanges` –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π UI
- ‚úÖ –§–ª–∞–≥ `hasChanges` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –§–ª–∞–≥ `hasChanges` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `RefreshOutboundOptions()` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Read"

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–æ–±–ª–µ–º—ã

### 1. FileServiceAdapter –∏ build tag `cgo`

**–ü—Ä–æ–±–ª–µ–º–∞:** `FileServiceAdapter` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ —Å build tag `//go:build cgo`, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –±–µ–∑ CGO.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å CGO (–∫–∞–∫ –≤ –ø—Ä–æ–µ–∫—Ç–µ) –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –û—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞ –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å.

**–°—Ç–∞—Ç—É—Å:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ø—Ä–æ–µ–∫—Ç–∞

### 2. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Ä–µ—à–µ–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–ª–∞–≥ `hasChanges` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ –∏–∑-–∑–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è callback'–æ–≤ –≤–∏–¥–∂–µ—Ç–æ–≤ (`outboundSelect`, `finalSelect`, `checkbox`) –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ `SetSelected()`.

**–†–µ—à–µ–Ω–∏–µ:** 
- –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `UpdatingOutboundOptions` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `hasChanges` –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –§–ª–∞–≥ `UpdatingOutboundOptions` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `true` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤–∏–¥–∂–µ—Ç–æ–≤ –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ `false` –ø–æ—Å–ª–µ –≤—Å–µ—Ö `SetSelected()` –≤—ã–∑–æ–≤–æ–≤ –≤ `RefreshOutboundOptions()`
- –§–ª–∞–≥ `hasChanges` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ `false` –≤–Ω—É—Ç—Ä–∏ —Ç–æ–≥–æ –∂–µ `UpdateUI()`, —á—Ç–æ –∏ `RefreshOutboundOptions()`, —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ `UpdatingOutboundOptions`
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ callback'–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –æ—Ç—Ä–∞–±–æ—Ç–∞—é—Ç –¥–æ —Å–±—Ä–æ—Å–∞ `hasChanges`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–æ (2026-02-09)

### 3. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ) –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã `MarkAsChanged()` –≤ –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞:
- –í callback'–∞—Ö `outboundSelect` –∏ `checkbox` –¥–ª—è selectable rules (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `!UpdatingOutboundOptions`)
- –í callback'–∞—Ö `outboundSelect` –∏ `checkbox` –¥–ª—è custom rules (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `!UpdatingOutboundOptions`)
- –í callback'–µ `finalSelect` (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `!UpdatingOutboundOptions`)
- –í –¥–∏–∞–ª–æ–≥–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª (`add_rule_dialog.go`)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `experimental.clash_api.secret`

**–ü—Ä–æ–±–ª–µ–º–∞:** `experimental.clash_api.secret` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ —á–µ—Ä–µ–∑ `SaveConfigWithBackup`, –Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `config_params` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, `experimental.clash_api.secret` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏ –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `state.json`. –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `SaveConfigWithBackup`.

**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ—Å—Ç—ã

1. **Unit-—Ç–µ—Å—Ç—ã:**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è (`ValidateStateID`)
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `RuleState` ‚Üî `PersistedRuleState`
   - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è `WizardStateFile`
   - –†–∞–±–æ—Ç–∞ StateStore (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞/—Å–ø–∏—Å–æ–∫)

2. **Integration-—Ç–µ—Å—Ç—ã:**
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –†–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

3. **E2E-—Ç–µ—Å—Ç—ã:**
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `state.json`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Save"
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Save As"
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Read"
   - –ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
go build ./ui/wizard/...

# –¢–µ—Å—Ç—ã (–µ—Å–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã)
go test ./ui/wizard/...

# –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
go vet ./ui/wizard/...
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `WIZARD_STATE_MANAGEMENT_SPEC.md` ‚Äî –ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `WIZARD_STATE_JSON_SCHEMA.md` ‚Äî —Å—Ö–µ–º–∞ JSON —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `IMPLEMENTATION_PROMPT.md` ‚Äî –æ–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

–í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å—Ç–∏–ª–µ Go:
- –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –∫–æ–¥–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π

1. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
   - –í—ã–∑–æ–≤—ã `MarkAsChanged()` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –¥–∏–∞–ª–æ–≥–∞—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `SelectableRuleStates` –∏ `CustomRules` —á–µ—Ä–µ–∑ callback'–∏ –≤–∏–¥–∂–µ—Ç–æ–≤

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π `experimental.clash_api.secret`:**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `experimental.clash_api.secret` –≤ `config_params` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞
   - –ó–∞–≥—Ä—É–∑–∫–∞ `experimental.clash_api.secret` –∏–∑ `config_params` –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

3. **–£–ª—É—á—à–µ–Ω–∏–µ UI:**
   - –ü–æ–∫–∞–∑ –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
   - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
   - –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DeleteWizardState`)

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º)
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π

5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –î–æ–±–∞–≤–∏—Ç—å integration-—Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –≤–∏–∑–∞—Ä–¥–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–∑–∞—Ä–¥–∞ –≤ `state.json` –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–∂–Ω—ã–º–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –ø–æ—Ç–µ—Ä–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–∂–Ω—ã–º–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º–∏ `hasChanges` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ —Ä–µ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–∞ `UpdatingOutboundOptions` –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–æ–≤ –≤ `RefreshOutboundOptions()`.

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-30  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-09

