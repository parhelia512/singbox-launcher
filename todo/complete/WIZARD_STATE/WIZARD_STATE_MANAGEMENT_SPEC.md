# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–∑–∞—Ä–¥–∞ –∏ —Ä–µ–∂–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Wizard ‚Üí Management)

**–ö—Ä–∞—Ç–∫–æ:**
–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—É—â–∏–π –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –≤–∏–∑–∞—Ä–¥ –≤ —Ä–µ–∂–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç "wizard state" (JSON v1) –∏ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã—Å—Ç—Ä–æ –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å `config.json`.

## üéØ –¶–µ–ª–∏
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑–∞—Ä–¥–∞ (–≤–∫–ª—é—á–∞—è –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏ —à–∞–±–ª–æ–Ω–∞, –ø—Ä–∞–≤–∏–ª–∞, URL –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤) –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª(—ã).
- –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏: —Å–ø–∏—Å–æ–∫, –∑–∞–≥—Ä—É–∑–∫–∞, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç.
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ.
- –°–æ–∫—Ä–∞—Ç–∏—Ç—å —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –±—ã—Å—Ç—Ä—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è/–ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

## –¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è `WizardModel` –≤ –ø–∞–º—è—Ç–∏ (`ui/wizard/models/wizard_model.go`).
- –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `@ParserConfig` –∏–∑ `config.json` –∏–ª–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞ (`ui/wizard/business/loader.go`).
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑–∞—Ä–¥–∞ –∂–∏–≤—ë—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –æ–∫–Ω–∞.
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `config.json` –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–¥–µ–ª–∏.

---

## –ñ–µ–ª–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –û–±—â–∏–π –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

–í–∏–∑–∞—Ä–¥ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ—Ç–æ–∫–∏ —Ä–∞–±–æ—Ç—ã

#### 1. –ü–æ—Ç–æ–∫: –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∏–∑–∞—Ä–¥  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ state.json?     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚îÄ‚îÄ –î–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ                                  ‚îÇ
       ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ   ‚îÇ –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π            ‚îÇ
       ‚îÇ   ‚îÇ (state.json –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ")          ‚îÇ
       ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ          ‚îÇ
       ‚îÇ          ‚îú‚îÄ‚ñ∫ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" (state.json)
       ‚îÇ          ‚îÇ   ‚îî‚îÄ‚ñ∫ LoadCurrentState()
       ‚îÇ          ‚îÇ       ‚îî‚îÄ‚ñ∫ –ü—Ä–æ—á–∏—Ç–∞—Ç—å state.json
       ‚îÇ          ‚îÇ           ‚îî‚îÄ‚ñ∫ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WizardModel
       ‚îÇ          ‚îÇ               ‚îî‚îÄ‚ñ∫ –í–∏–∑–∞—Ä–¥ –æ—Ç–∫—Ä—ã—Ç —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
       ‚îÇ          ‚îÇ
       ‚îÇ          ‚îú‚îÄ‚ñ∫ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ"
       ‚îÇ          ‚îÇ   ‚îî‚îÄ‚ñ∫ LoadConfigFromFile()
       ‚îÇ          ‚îÇ       ‚îî‚îÄ‚ñ∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ config.json/—à–∞–±–ª–æ–Ω–∞
       ‚îÇ          ‚îÇ           ‚îî‚îÄ‚ñ∫ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å WizardModel
       ‚îÇ          ‚îÇ               ‚îî‚îÄ‚ñ∫ –í–∏–∑–∞—Ä–¥ –æ—Ç–∫—Ä—ã—Ç —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
       ‚îÇ          ‚îÇ
       ‚îÇ          ‚îî‚îÄ‚ñ∫ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞
       ‚îÇ              ‚îî‚îÄ‚ñ∫ LoadWizardState(id)
       ‚îÇ                  ‚îú‚îÄ‚ñ∫ –ü—Ä–æ—á–∏—Ç–∞—Ç—å <id>.json
       ‚îÇ                  ‚îú‚îÄ‚ñ∫ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–ø–∏—é –≤ state.json
       ‚îÇ                              ‚îî‚îÄ‚ñ∫ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WizardModel
       ‚îÇ                                  ‚îî‚îÄ‚ñ∫ –í–∏–∑–∞—Ä–¥ –æ—Ç–∫—Ä—ã—Ç —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
       ‚îÇ
       ‚îÇ  –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ hasUnsavedChanges()
       ‚îÇ  –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –µ—â—ë –Ω–µ—Ç.
       ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ –ù–ï–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                           ‚îÇ
                                           ‚ñº
                           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                           ‚îÇ LoadConfigFromFile()          ‚îÇ
                           ‚îÇ (—Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)           ‚îÇ
                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                                   ‚ñº
                           –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ config.json/—à–∞–±–ª–æ–Ω–∞
                                   ‚îÇ
                                   ‚ñº
                           –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å WizardModel
                                   ‚îÇ
                                   ‚ñº
                           –í–∏–∑–∞—Ä–¥ –æ—Ç–∫—Ä—ã—Ç —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
                           –∏–∑ config.json/—à–∞–±–ª–æ–Ω–∞
```

#### 2. –ü–æ—Ç–æ–∫: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∫–Ω–æ–ø–∫–∞ "Save")

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Save"
    ‚îÇ
    ‚ñº
Presenter.SaveCurrentState()
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ –°–æ–∑–¥–∞—Ç—å WizardStateFile –∏–∑ WizardModel
    ‚îÇ
    ‚ñº
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ state.json?
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –î–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ               ‚ñº
    ‚îÇ   –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ "Save As"
    ‚îÇ   (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ state.json)
    ‚îÇ   ‚îÇ                                                
    ‚îÇ   ‚îú‚îÄ‚ñ∫ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π             
    ‚îÇ   ‚îú‚îÄ‚ñ∫ ValidateStateID(id)                      
    ‚îÇ   ‚îú‚îÄ‚ñ∫ SaveWizardState(previousState, id) ‚Üí <id>.json   
    ‚îÇ   ‚îî‚îÄ‚ñ∫ SaveCurrentState(currentState) ‚Üí state.json     
    ‚îÇ                                                
    ‚îÇ   ‚îî‚îÄ‚ñ∫ "–û—Ç–º–µ–Ω–∞"                                     
    ‚îÇ       ‚îî‚îÄ‚ñ∫ –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞                        
    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ù–ï–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                    ‚îÇ
                           SaveCurrentState(state)
                                    ‚îÇ
                                    ‚ñº
                            –°–æ–∑–¥–∞—Ç—å state.json
                                    ‚îÇ
                                    ‚ñº
                            –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
```

#### 3. –ü–æ—Ç–æ–∫: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Read"

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Read"
    ‚îÇ
    ‚ñº
StateStore.ListWizardStateNames()
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö .json —Ñ–∞–π–ª–æ–≤ –∏–∑ bin/wizard_states/
    ‚îú‚îÄ‚ñ∫ –ß–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ (–±–µ–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)
    ‚îú‚îÄ‚ñ∫ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (ID, IsCurrent, –≤—Ä–µ–º—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏)
    ‚îî‚îÄ‚ñ∫ –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
        ‚îÇ
        ‚ñº
–ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ –ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (~5 —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π)
    ‚îú‚îÄ‚ñ∫ –ö–Ω–æ–ø–∫–∏: "Load", "New", "Cancel"
    ‚îî‚îÄ‚ñ∫ state.json –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ" (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
        ‚îÇ
        ‚ñº
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "Load"
    ‚îÇ
    ‚ñº
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: hasUnsavedChanges()?
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ –î–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                                                     ‚îÇ
    ‚îÇ   –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:                    ‚îÇ
    ‚îÇ   "–¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.                ‚îÇ
    ‚îÇ    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?"                    ‚îÇ
    ‚îÇ                                                     ‚îÇ
    ‚îÇ   ‚îú‚îÄ‚ñ∫ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"                                   ‚îÇ
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚ñ∫ –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ "Save As"                 ‚îÇ
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚ñ∫ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π      ‚îÇ
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚ñ∫ ValidateStateID(id)                       ‚îÇ
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚ñ∫ SaveWizardState(state, id) ‚Üí <id>.json    ‚îÇ
    ‚îÇ   ‚îÇ       ‚îî‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É                   ‚îÇ
    ‚îÇ   ‚îÇ                                                 ‚îÇ
    ‚îÇ   ‚îú‚îÄ‚ñ∫ "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å"                                ‚îÇ
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É                       ‚îÇ
    ‚îÇ   ‚îÇ                                                 ‚îÇ
    ‚îÇ   ‚îî‚îÄ‚ñ∫ "–û—Ç–º–µ–Ω–∞"                                      ‚îÇ
    ‚îÇ       ‚îî‚îÄ‚ñ∫ –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞, –æ—Å—Ç–∞—Ç—å—Å—è –≤ –≤–∏–∑–∞—Ä–¥–µ     ‚îÇ
    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ –ù–ï–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                                ‚îÇ
                                                ‚ñº
                                    Presenter.LoadState(id)
                                        ‚îÇ
                                        ‚îú‚îÄ‚ñ∫ StateStore.LoadWizardState(id)
                                        ‚îÇ   ‚îî‚îÄ‚ñ∫ –ü—Ä–æ—á–∏—Ç–∞—Ç—å <id>.json
                                        ‚îÇ       ‚îî‚îÄ‚ñ∫ –í–µ—Ä–Ω—É—Ç—å WizardStateFile
                                        ‚îÇ
                                        ‚îú‚îÄ‚ñ∫ StateStore.SaveCurrentState() (–∫–æ–ø–∏—è)
                                        ‚îÇ   ‚îî‚îÄ‚ñ∫ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ state.json
                                        ‚îÇ
                                        ‚îî‚îÄ‚ñ∫ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WizardModel –∏–∑ —Ñ–∞–π–ª–∞
                                            ‚îÇ
                                            ‚îú‚îÄ‚ñ∫ 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω (TemplateData)
                                            ‚îú‚îÄ‚ñ∫ 2. –û–±–Ω–æ–≤–∏—Ç—å parser_config
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ model.ParserConfigJSON = —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å parser_config
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ model.ParserConfig = parser_config
                                            ‚îú‚îÄ‚ñ∫ 3. –ò–∑–≤–ª–µ—á—å SourceURLs –∏–∑ parser_config
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ model.SourceURLs = –∏–∑–≤–ª–µ—á—å –∏–∑ parser_config.proxies

**‚ö†Ô∏è TODO:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parser_config.ParserConfig.proxies`. –ü–æ—Å–ª–µ —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É–¥–µ—Ç `parser_config.proxies`. –ó–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.
                                            ‚îú‚îÄ‚ñ∫ 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å config_params
                                            ‚îÇ       ‚îú‚îÄ‚ñ∫ –ù–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä "route.final" –≤ config_params
                                            ‚îÇ       ‚îú‚îÄ‚ñ∫ model.SelectedFinalOutbound = param.Value (–∏–ª–∏ TemplateData.DefaultFinal –µ—Å–ª–∏ –ø—É—Å—Ç–æ)
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞
                                            ‚îú‚îÄ‚ñ∫ 5. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TemplateSectionSelections
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏ = true (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å)
                                            ‚îú‚îÄ‚ñ∫ 6. –û–±–Ω–æ–≤–∏—Ç—å SelectableRuleStates
                                            ‚îÇ       ‚îî‚îÄ‚ñ∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑ —Ñ–∞–π–ª–∞ (rule.raw, label, description, type, enabled, selected_outbound)
                                            ‚îî‚îÄ‚ñ∫ 7. –û–±–Ω–æ–≤–∏—Ç—å CustomRules
                                                    ‚îî‚îÄ‚ñ∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑ —Ñ–∞–π–ª–∞
                                                ‚îÇ
                                                ‚ñº
                                            –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ GeneratedOutbounds
                                                ‚îÇ
                                                ‚ñº
                                            –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å GUI —Å –º–æ–¥–µ–ª—å—é
                                                ‚îÇ
                                                ‚ñº
                                            hasChanges = false
                                                ‚îÇ
                                                ‚ñº
                                            –í–∏–∑–∞—Ä–¥ –æ–±–Ω–æ–≤–ª—ë–Ω —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
```

#### 4. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–∑–∞—Ä–¥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   [–°—Ç–∞—Ä—Ç]   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü—Ä–æ–≤–µ—Ä–∫–∞      ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ state.json?     ‚îÇ                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îÇ
    ‚îÇ       ‚îÇ                          ‚îÇ
    ‚îú‚îÄ –î–ê   ‚îú‚îÄ –ù–ï–¢                     ‚îÇ
    ‚îÇ       ‚îÇ                          ‚îÇ
    ‚ñº       ‚ñº                          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ    ‚îÇ  ‚îÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ       ‚îÇ  ‚îÇ
‚îÇ –∏–∑ state.json‚îÇ  ‚îÇ –∏–∑ config.json  ‚îÇ  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
       ‚îÇ                   ‚îÇ           ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
                  ‚îÇ                    ‚îÇ
                  ‚ñº                    ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
         ‚îÇ  –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚îÇ           ‚îÇ
         ‚îÇ  (hasChanges)   ‚îÇ           ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
               ‚îÇ       ‚îÇ               ‚îÇ
               ‚îÇ       ‚îú‚îÄ‚ñ∫ "Save" ‚Üí state.json
               ‚îÇ       ‚îÇ   ‚îî‚îÄ‚ñ∫ hasChanges = false
               ‚îÇ       ‚îÇ
               ‚îÇ       ‚îú‚îÄ‚ñ∫ "Save As" ‚Üí <id>.json
               ‚îÇ       ‚îÇ   ‚îî‚îÄ‚ñ∫ hasChanges = false
               ‚îÇ       ‚îÇ
               ‚îÇ       ‚îî‚îÄ‚ñ∫ "Read" ‚Üí –≤—ã–±–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è
               ‚îÇ           ‚îî‚îÄ‚ñ∫ –ó–∞–≥—Ä—É–∑–∏—Ç—å ‚Üí hasChanges = false
               ‚îÇ
               ‚ñº
         –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤–∏–∑–∞—Ä–¥
               ‚îÇ
               ‚îú‚îÄ‚ñ∫ hasChanges = false
               ‚îÇ   ‚îî‚îÄ‚ñ∫ –ó–∞–∫—Ä—ã—Ç—å –±–µ–∑ –¥–∏–∞–ª–æ–≥–∞
               ‚îÇ
               ‚îî‚îÄ‚ñ∫ hasChanges = true
                   ‚îÇ
                   ‚ñº
           –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥:
           "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?"
                   ‚îÇ
                   ‚îú‚îÄ‚ñ∫ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
                   ‚îÇ   ‚îî‚îÄ‚ñ∫ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ state.json
                   ‚îÇ       ‚îî‚îÄ‚ñ∫ –ó–∞–∫—Ä—ã—Ç—å
                   ‚îÇ
                   ‚îú‚îÄ‚ñ∫ "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å"
                   ‚îÇ   ‚îî‚îÄ‚ñ∫ –ó–∞–∫—Ä—ã—Ç—å –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                   ‚îÇ
                   ‚îî‚îÄ‚ñ∫ "–û—Ç–º–µ–Ω–∞"
                       ‚îî‚îÄ‚ñ∫ –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é ‚îÄ‚îÄ‚îò
```

### –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∏–∑–∞—Ä–¥
2. `state.json` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –í–∏–∑–∞—Ä–¥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `config.json` –∏–ª–∏ —à–∞–±–ª–æ–Ω–∞ (—Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∏–∑–∞—Ä–¥–æ–º, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Save"
6. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `state.json`

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∏–∑–∞—Ä–¥
2. `state.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (`state.json` –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ")
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–ó–∞–≥—Ä—É–∑–∏—Ç—å"
5. –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ `state.json`
6. –í–∏–∑–∞—Ä–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å —Ç–µ–º–∏ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, —á—Ç–æ –±—ã–ª–∏ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –†–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∏–∑–∞—Ä–¥–æ–º, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é "–†–∞–±–æ—Ç–∞"
2. –ù–∞–∂–∏–º–∞–µ—Ç "Save As", –≤–≤–æ–¥–∏—Ç ID: `work-config`
3. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `work-config.json`
4. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ "Read"
5.–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ "–î–æ–º"
6. –ù–∞–∂–∏–º–∞–µ—Ç "Save As", –≤–≤–æ–¥–∏—Ç ID: `home-config`
7. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `home-config.json`

#### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∏–∑–∞—Ä–¥–æ–º, –µ—Å—Ç—å `state.json`
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –ù–∞–∂–∏–º–∞–µ—Ç "Save"
4. –°—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ "Save As" –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `backup-config`)
6. –ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `backup-config.json`
7. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `state.json`

#### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ó–∞–∫—Ä—ã—Ç–∏–µ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∏–∑–∞—Ä–¥–æ–º, –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–∫—Ä—ã—Ç—å –≤–∏–∑–∞—Ä–¥
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º?"
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
5. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `state.json` (–µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤)
6. –í–∏–∑–∞—Ä–¥ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

#### –°—Ü–µ–Ω–∞—Ä–∏–π 6: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∏–∑–∞—Ä–¥–æ–º, –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç)
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Read" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä—É–≥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: "–¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?"
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
7. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ "Save As", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `temp-config`)
8. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `temp-config.json`
9. –í—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `state.json`
10. –í–∏–∑–∞—Ä–¥ –æ–±–Ω–æ–≤–ª—ë–Ω —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø–æ—Ç–µ—Ä—è–Ω—ã

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è

–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑–∞—Ä–¥–∞ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –∏–∑ `WizardModel` –≤ JSON-—Ñ–∞–π–ª. –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:

- **ParserConfig** ‚Äî JSON –æ–±—ä–µ–∫—Ç —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–∞—Ä—Å–µ—Ä–∞ (–∏–∑ `model.ParserConfigJSON`, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –æ–±—ä–µ–∫—Ç, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∞). –≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ `@ParserConfig` –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–≤–∏–∑–∞—Ä–¥ –∏ –∫–Ω–æ–ø–∫–∞ "üîÑ Update").
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `SourceURLs` –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äî URL'—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ `parser_config.proxies` (–ø–æ–ª—è `source` –∏ `connections`) –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**‚ö†Ô∏è TODO:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parser_config.ParserConfig.proxies`. –ü–æ—Å–ª–µ —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É–¥–µ—Ç `parser_config.proxies`. –ó–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.
- **ConfigParams** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–º–∞—Å—Å–∏–≤ `ConfigParam`), –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞. –ö–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–º–µ–µ—Ç –∏–º—è (–ø—É—Ç—å –≤ JSON –≤ —Ç–æ—á–µ—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏) –∏ –∑–Ω–∞—á–µ–Ω–∏–µ. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `route.final`, `experimental.clash_api.secret`.
- **SelectableRuleStates** ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∞–≤–∏–ª –∏–∑ —à–∞–±–ª–æ–Ω–∞ (–∏–∑ `model.SelectableRuleStates`), –≤–∫–ª—é—á–∞—è –ø–æ–ª–µ `type` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `"System"` –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª, –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —Ç–∏–ø)
- **CustomRules** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ (–∏–∑ `model.CustomRules`), –≤–∫–ª—é—á–∞—è –ø–æ–ª–µ `type` —Å —Ç–∏–ø–æ–º –ø—Ä–∞–≤–∏–ª–∞

**–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è (–≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è/–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ):**
- **TemplateData** ‚Äî —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ (`config_template.json` –∏–ª–∏ `config_template_macos.json`) –≤—Å–µ–≥–¥–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Å–µ–∫—Ü–∏–∏):
  - `Sections` (map[string]json.RawMessage) ‚Äî —Å–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ —à–∞–±–ª–æ–Ω–∞ (route, dns, inbounds, outbounds, experimental –∏ —Ç.–¥.). **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ —à–∞–±–ª–æ–Ω–∞** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞
  - `SectionOrder` ([]string) ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–µ–∫—Ü–∏–π –≤ —à–∞–±–ª–æ–Ω–µ. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ —à–∞–±–ª–æ–Ω–∞** –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - `SelectableRules` ([]TemplateSelectableRule) ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ —à–∞–±–ª–æ–Ω–∞ (–∏–∑ `@SelectableRule` –±–ª–æ–∫–æ–≤). **–í —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** (–ø—Ä–∞–≤–∏–ª–∞ –±–µ—Ä—É—Ç—Å—è –∏–∑ `state.json`), **–≤ —Ä–µ–∂–∏–º–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ" –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
  - `DefaultFinal` (string) ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π outbound –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ —Å–µ–∫—Ü–∏–∏ `route` —à–∞–±–ª–æ–Ω–∞. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback**, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω –≤ `config_params`
  - `HasParserOutboundsBlock` (bool) ‚Äî –µ—Å—Ç—å –ª–∏ –º–∞—Ä–∫–µ—Ä `@PARSER_OUTBOUNDS_BLOCK` –≤ —à–∞–±–ª–æ–Ω–µ. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ —à–∞–±–ª–æ–Ω–∞** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫—É–¥–∞ –≤—Å—Ç–∞–≤–ª—è—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ outbounds
  - `OutboundsAfterMarker` (string) ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–∞ `@PARSER_OUTBOUNDS_BLOCK` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `direct-out`). **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ —à–∞–±–ª–æ–Ω–∞** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö outbounds
  - **–í —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** —à–∞–±–ª–æ–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–µ–∫—Ü–∏–∏), –Ω–æ –ø—Ä–∞–≤–∏–ª–∞ –±–µ—Ä—É—Ç—Å—è –∏–∑ `state.json`
  - **–í —Ä–µ–∂–∏–º–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ":** —à–∞–±–ª–æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–≤–∫–ª—é—á–∞—è –ø—Ä–∞–≤–∏–ª–∞)
- **GeneratedOutbounds** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ ParserConfig –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ
- **TemplatePreviewText** ‚Äî –∫—ç—à preview, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 2. –§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `<execDir>/bin/wizard_states/` (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**–§–∞–π–ª—ã:**
- `state.json` ‚Äî —Ç–µ–∫—É—â–µ–µ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏)
- `<state_id>.json` ‚Äî –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `my-config.json`, `work-vpn.json`)

**–ü—Ä–∞–≤–∏–ª–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è:**
- ID —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã (a-z, A-Z), —Ü–∏—Ñ—Ä—ã (0-9), –¥–µ—Ñ–∏—Å (-) –∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ (_)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ ID: 50 —Å–∏–º–≤–æ–ª–æ–≤
- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ `<state_id>.json` (–±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤)

**–§–æ—Ä–º–∞—Ç:** UTF-8 JSON —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```json
{
  "version": 1,
  "id": "my-config",
  "comment": "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã",
  "created_at": "2026-01-30T12:00:00Z",
  "updated_at": "2026-01-30T15:30:00Z",
  
  "parser_config": {
      "version": 4,
      "proxies": [
        {
          "source": "https://example.com/sub.txt"
        }
      ],
      "outbounds": [],
      "parser": {
        "reload": "1h",
        "last_updated": "2026-01-30T12:00:00Z"
      }
    }
  },
  "config_params": [
    {
      "name": "route.final",
      "value": "proxy-out"
    },
    {
      "name": "experimental.clash_api.secret",
      "value": "my-secret-token-12345"
    }
  ],
  "selectable_rule_states": [
    {
      "type": "System",
        "rule": {
        "label": "Block ads",
        "description": "Block advertisement domains",
        "raw": {
          "domain_suffix": ["ads.example.com"],
          "action": "reject"
        },
        "default_outbound": "reject",
        "has_outbound": false,
        "is_default": true
      },
      "enabled": true,
      "selected_outbound": "reject"
    }
  ],
  "custom_rules": [
    {
      "type": "Domains/URLs",
      "rule": {
        "label": "Custom rule",
        "description": "Route example.com to proxy",
        "raw": {
          "domain": ["example.com"],
          "outbound": "proxy-out"
        },
        "default_outbound": "proxy-out",
        "has_outbound": true,
        "is_default": false
      },
      "enabled": true,
      "selected_outbound": "proxy-out"
    }
  ]
} 
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- –ü–æ–ª–µ `version` –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–Ω–æ 1 –≤ –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ (–º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è)
- –ü–æ–ª—è `created_at` –∏ `updated_at` –≤ —Ñ–æ—Ä–º–∞—Ç–µ RFC3339 –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ UI
- –ü–æ–ª–µ `id` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è `state.json` (–∏–º—è —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º), –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞
- –ü–æ–ª–µ `comment` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π/–æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `parser_config` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ JSON –æ–±—ä–µ–∫—Ç (–Ω–µ —Å—Ç—Ä–æ–∫–∞)
- `parser_config` —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º `@ParserConfig` –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∏–∑–∞—Ä–¥–æ–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "üîÑ Update" –≤ –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  - –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç—Ç–æ—Ç –±–ª–æ–∫ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ `config.json` –∫–∞–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `/** @ParserConfig */`
- **–í–∞–∂–Ω–æ:** `@ParserConfig` –±–æ–ª—å—à–µ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `config.json` (—Ç–æ–ª—å–∫–æ –≤ `state.json`). –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–∑–∞—Ä–¥ –∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –±–ª–æ–∫ –≤–º–µ—Å—Ç–æ `config.json`
- `config_params` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `route.final`, `experimental.clash_api.secret`)
- `selectable_rule_states` –∏ `custom_rules` —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `RuleState` —Å `TemplateSelectableRule`, –≤–∫–ª—é—á–∞—è –ø–æ–ª–µ `type`

### 3. Go-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```go
// WizardStateFile –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑–∞—Ä–¥–∞
type WizardStateFile struct {
    Version                  int                    `json:"version"`
    ID                       string                 `json:"id,omitempty"` // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è state.json, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
    Comment                  string                 `json:"comment,omitempty"`
    CreatedAt                time.Time              `json:"created_at"`
    UpdatedAt                time.Time              `json:"updated_at"`
    
    ParserConfig             config.ParserConfig    `json:"parser_config"`
    ConfigParams             []ConfigParam          `json:"config_params"`
    SelectableRuleStates     []PersistedRuleState   `json:"selectable_rule_states"`
    CustomRules              []PersistedRuleState   `json:"custom_rules"`
}

// ConfigParam –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
type ConfigParam struct {
    Name  string `json:"name"`  // –ü—É—Ç—å –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—É –≤ —Ç–æ—á–µ—á–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "route.final", "experimental.clash_api.secret")
    Value string `json:"value"`  // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
}

// PersistedRuleState - —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è RuleState
type PersistedRuleState struct {
    Type             string                          `json:"type"` // "System" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —Ç–∏–ø), –∏–ª–∏ "IP Addresses (CIDR)", "Domains/URLs", "Processes", "Custom JSON" –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö
    Rule             PersistedTemplateSelectableRule `json:"rule"`
    Enabled          bool                            `json:"enabled"`
    SelectedOutbound string                          `json:"selected_outbound"`
}

// PersistedTemplateSelectableRule - —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è TemplateSelectableRule
type PersistedTemplateSelectableRule struct {
    Label           string                 `json:"label"`
    Description     string                 `json:"description"`
    Raw             map[string]interface{} `json:"raw"`
    DefaultOutbound string                 `json:"default_outbound"`
    HasOutbound     bool                   `json:"has_outbound"`
    IsDefault       bool                   `json:"is_default"`
}

// WizardStateMetadata - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Å–ø–∏—Å–∫–∞
type WizardStateMetadata struct {
    ID        string    `json:"id"`
    Comment   string    `json:"comment,omitempty"` // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º)
    CreatedAt time.Time `json:"created_at"`
    UpdatedAt time.Time `json:"updated_at"`
    IsCurrent bool      `json:"is_current"` // true –µ—Å–ª–∏ —ç—Ç–æ state.json
}
```

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –ö–Ω–æ–ø–∫–∞ "Save"
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `state.json`
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at`:** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (time.Now()) –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –ï—Å–ª–∏ `state.json` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
  - –°—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ "Save As" –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  - –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –≤ `state.json`
  - –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –¥–∏–∞–ª–æ–≥–∞ "Save As" ‚Äî –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞, `state.json` –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
- –ï—Å–ª–∏ `state.json` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–µ–∑ –¥–∏–∞–ª–æ–≥–æ–≤

#### –ö–Ω–æ–ø–∫–∞ "Save As"
- –í—Å–µ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç ID –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç ID (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å, –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ; –º–∞–∫—Å. 50 —Å–∏–º–≤–æ–ª–æ–≤)
- –ï—Å–ª–∏ ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –¥–∏–∞–ª–æ–≥–µ: "–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ë—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ." –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ —Ñ–∞–π–ª `<state_id>.json`
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `created_at` –∏ `updated_at`:** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (time.Now()) –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ù–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `state.json` (–∫—Ä–æ–º–µ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ "Save" —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `state.json`)

**–í–∞–∂–Ω–æ:** `updated_at` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è** —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ "Save" –∏–ª–∏ "Save As". –ü—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "üîÑ Update" –≤ –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `parser_config.parser.last_updated`, –Ω–æ **–Ω–µ** `updated_at` –≤ `state.json` (—Ç–∞–∫ –∫–∞–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞

**–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
- –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç `state.json` ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∞–≤–∏–ª–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, ParserConfig) –±–µ—Ä—É—Ç—Å—è –∏–∑ `state.json`
- –®–∞–±–ª–æ–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–µ–∫—Ü–∏–∏)

**–†–µ–∂–∏–º "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ":**
- –û–ø—Ü–∏—è –≤ UI, –∫–æ—Ç–æ—Ä–∞—è –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `state.json`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ —à–∞–±–ª–æ–Ω –æ–±–Ω–æ–≤–∏–ª—Å—è –∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `config_params` –≤ —Ä–µ–∂–∏–º–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ":**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ –≤–∏–∑–∞—Ä–¥–∞:
  - `route.final`: –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `TemplateData.DefaultFinal` (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ —à–∞–±–ª–æ–Ω–µ), –∏–Ω–∞—á–µ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ `""`
  - `experimental.clash_api.secret`: **–Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è** ‚Äî –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ —á–µ—Ä–µ–∑ `SaveConfigWithBackup` (–∫–∞–∫ —Å–µ–π—á–∞—Å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ –≤–∏–∑–∞—Ä–¥–∞)
- –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ UI –≤–∏–∑–∞—Ä–¥–∞

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `config_params` –≤ —Ä–µ–∂–∏–º–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ":**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ –≤–∏–∑–∞—Ä–¥–∞:
  - `route.final`: –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `TemplateData.DefaultFinal` (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ —à–∞–±–ª–æ–Ω–µ), –∏–Ω–∞—á–µ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ `""`
  - `experimental.clash_api.secret`: **–Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è** ‚Äî –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ —á–µ—Ä–µ–∑ `SaveConfigWithBackup` (–∫–∞–∫ —Å–µ–π—á–∞—Å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏–∑ –≤–∏–∑–∞—Ä–¥–∞)
- –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ UI –≤–∏–∑–∞—Ä–¥–∞

#### –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ `state.json` –≤ `bin/wizard_states/` –∏ –¥—Ä—É–≥–∏—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
2. –ï—Å–ª–∏ –µ—Å—Ç—å `state.json` –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
   - –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (`load_state_dialog.go`)
   - `state.json` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ" (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
   - –í–∞—Ä–∏–∞–Ω—Ç—ã: "–ó–∞–≥—Ä—É–∑–∏—Ç—å" (–≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–ª–∏ `state.json`), "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ", "–û—Ç–º–µ–Ω–∞"
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∏–ª–∏ `state.json`) –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `WizardModel`
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–Ω–æ–≤–æ" ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–û—Ç–º–µ–Ω–∞" ‚Äî –∑–∞–∫—Ä—ã—Ç—å –≤–∏–∑–∞—Ä–¥
3. –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ—Ç:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ª–æ–≥–∏–∫—É (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞)

#### –ö–Ω–æ–ø–∫–∞ "Read" (–≤ –Ω–∞—á–∞–ª–µ –≤–∏–∑–∞—Ä–¥–∞)
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (`hasUnsavedChanges()`)
  - –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
    - –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: "–¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?"
    - –í–∞—Ä–∏–∞–Ω—Ç—ã: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" (–æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ "Save As"), "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å", "–û—Ç–º–µ–Ω–∞"
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ "Save As" –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∑–∞—Ç–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å" ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ—Ç–µ—Ä—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–û—Ç–º–µ–Ω–∞" ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é, –æ—Å—Ç–∞—Ç—å—Å—è –≤ –≤–∏–∑–∞—Ä–¥–µ
  - –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–≥—Ä—É–∑–∫—É:
    - –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å
    - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ `state.json` –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ"
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `WizardModel` –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (—Å–º. –¥–µ—Ç–∞–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∏–∂–µ)
  - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `hasChanges = false`

#### –î–µ—Ç–∞–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è WizardModel

–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ `WizardStateFile` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω** (`TemplateData`) –∏–∑ —Ñ–∞–π–ª–∞ (`config_template.json` –∏–ª–∏ `config_template_macos.json`)
   - –®–∞–±–ª–æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–µ–∫—Ü–∏–∏)

2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `parser_config`:**
   - `model.ParserConfig = stateFile.ParserConfig`
   - –°–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å `parser_config` –≤ JSON —Å—Ç—Ä–æ–∫—É: `model.ParserConfigJSON = SerializeParserConfig(stateFile.ParserConfig)`

3. **–ò–∑–≤–ª–µ—á—å `SourceURLs` –∏–∑ `parser_config`:**
   - –ü—Ä–æ–π—Ç–∏ –ø–æ `parser_config.proxies`

**‚ö†Ô∏è TODO:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parser_config.ParserConfig.proxies`. –ü–æ—Å–ª–µ —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É–¥–µ—Ç `parser_config.proxies`. –ó–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.
   - –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è `source` –∏ `connections` –≤ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç
   - `model.SourceURLs = –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ URL'—ã —á–µ—Ä–µ–∑ "\n"`

4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `config_params` –∏ –º–∞–ø–ø–∏–Ω–≥ –≤ –º–æ–¥–µ–ª—å:**
   - –ù–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å `name = "route.final"` –≤ `config_params`
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω: `model.SelectedFinalOutbound = param.Value`
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ `value = ""`: `model.SelectedFinalOutbound = TemplateData.DefaultFinal` (fallback –∏–∑ —à–∞–±–ª–æ–Ω–∞)
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `config_params` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `experimental.clash_api.secret`)

5. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `TemplateSectionSelections`:**
   - –î–ª—è –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏ –∏–∑ `TemplateData.SectionOrder`: `model.TemplateSectionSelections[key] = true`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –≤—ã–±–æ—Ä —Å–µ–∫—Ü–∏–π –≤ UI, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ–≥–¥–∞ –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã

6. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `SelectableRuleStates`:**
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑ `stateFile.SelectableRuleStates`
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Å –ø–æ–ª—è–º–∏: `rule.raw`, `rule.label`, `rule.description`, `type`, `enabled`, `selected_outbound`

7. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `CustomRules`:**
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑ `stateFile.CustomRules`
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Å –ø–æ–ª—è–º–∏: `rule.raw`, `rule.label`, `rule.description`, `type`, `enabled`, `selected_outbound`

8. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥:**
   - –í—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `model.GeneratedOutbounds` –∏–∑ `model.ParserConfig`

9. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å GUI:**
   - –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é

### 3. –ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∏–∑–∞—Ä–¥–∞

- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ (–∫–Ω–æ–ø–∫–∞ "Close" –∏–ª–∏ –∫—Ä–µ—Å—Ç–∏–∫):
  - –ï—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ñ–ª–∞–≥ `hasChanges`):
    - –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º?"
    - –í–∞—Ä–∏–∞–Ω—Ç—ã: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å", "–û—Ç–º–µ–Ω–∞"
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å":
      - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `state.json` (–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å, –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤)
      - –ó–∞–∫—Ä—ã—Ç—å –≤–∏–∑–∞—Ä–¥
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å" ‚Äî –∑–∞–∫—Ä—ã—Ç—å –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ—Ç–µ—Ä—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–û—Ç–º–µ–Ω–∞" ‚Äî –æ—Å—Ç–∞—Ç—å—Å—è –≤ –≤–∏–∑–∞—Ä–¥–µ
  - –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç (`hasChanges = false`) ‚Äî –∑–∞–∫—Ä—ã—Ç—å –±–µ–∑ –¥–∏–∞–ª–æ–≥–∞

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### –í–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ: –±—É–∫–≤—ã (a-z, A-Z), —Ü–∏—Ñ—Ä—ã (0-9), –¥–µ—Ñ–∏—Å (-), –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ (_)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 50 —Å–∏–º–≤–æ–ª–æ–≤
- –ü—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º ID ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª

#### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1, –ø—Ä–∏ –¥—Ä—É–≥–∏—Ö –≤–µ—Ä—Å–∏—è—Ö ‚Äî –æ—à–∏–±–∫–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è —Ñ–æ—Ä–º–∞—Ç–∞")
- –í–∞–ª–∏–¥–∞—Ü–∏—è JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π: `version`, `parser_config`, `config_params`, `selectable_rule_states`, `custom_rules`
- –í–∞–ª–∏–¥–∞—Ü–∏—è `id` (–µ—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç): —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –º–∞–∫—Å. 50 —Å–∏–º–≤–æ–ª–æ–≤, —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞

**‚ö†Ô∏è TODO:** –¢–µ–∫—É—â–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è `parser_config` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è `ParserConfig` –≤–Ω—É—Ç—Ä–∏. –ü–æ—Å–ª–µ —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª—è `version`, `proxies`, `outbounds`, `parser` –Ω–∞–ø—Ä—è–º—É—é. –ó–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏:**

1. **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π `parser_config`:**
   - –ï—Å–ª–∏ `parser_config` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º JSON –æ–±—ä–µ–∫—Ç–æ–º –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (`version`, `proxies`, `outbounds`, `parser`)
   - –î–µ–π—Å—Ç–≤–∏–µ: –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π parser_config –≤ —Ñ–∞–π–ª–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è", fallback –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞

**‚ö†Ô∏è TODO:** –¢–µ–∫—É—â–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è `ParserConfig` –≤–Ω—É—Ç—Ä–∏ `parser_config`. –ü–æ—Å–ª–µ —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª—è –Ω–∞–ø—Ä—è–º—É—é. –ó–∞–¥–∞—á–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

2. **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ `config_params`:**
   - –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–º–µ–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"invalid.path"` –∏–ª–∏ –ø—É—Å—Ç–æ–µ –∏–º—è)
   - –î–µ–π—Å—Ç–≤–∏–µ: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É

3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä `route.final` –≤ `config_params`:**
   - –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `route.final` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - –î–µ–π—Å—Ç–≤–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ —à–∞–±–ª–æ–Ω–∞ (`TemplateData.DefaultFinal`), –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É

4. **–ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –≤ `selectable_rule_states` –∏–ª–∏ `custom_rules`:**
   - –ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–æ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (`rule`, `enabled`, `selected_outbound`) –∏–ª–∏ `rule.raw` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º JSON –æ–±—ä–µ–∫—Ç–æ–º
   - –î–µ–π—Å—Ç–≤–∏–µ: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

5. **–ü—Ä–∞–≤–∏–ª–æ —Å `type="System"` –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —à–∞–±–ª–æ–Ω—É:**
   - –ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–æ –∏–º–µ–µ—Ç `type="System"`, –Ω–æ `rule.raw` –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏ –æ–¥–Ω–æ–º—É –ø—Ä–∞–≤–∏–ª—É –∏–∑ —à–∞–±–ª–æ–Ω–∞
   - –î–µ–π—Å—Ç–≤–∏–µ: –æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –∫–∞–∫ –µ—Å—Ç—å (–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–∏–ª —Ç–∏–ø –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π), –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É

6. **–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–±–ª–æ–Ω–∞:**
   - –ï—Å–ª–∏ —à–∞–±–ª–æ–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ —Ñ–∞–π–ª–∞
   - –î–µ–π—Å—Ç–≤–∏–µ: –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω", fallback –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞

7. **–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
   - –ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥ `parser_config` –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π
   - –î–µ–π—Å—Ç–≤–∏–µ: –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è", –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

**–û–±—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON, –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è) ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É –∏ fallback –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞
- –ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–∞–≤–∏–ª–∞) ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
- –ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 256 KB, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–ø–∏—Å–∏ (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤, –¥–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –∏ —Ç.–¥.)
- –ü—Ä–∏ "Save As" —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º ID:
  - –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –¥–∏–∞–ª–æ–≥–µ "Save As": "–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ë—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ."
  - –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤

---

## –î–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞

–í—Å–µ –¥–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞ —Å–≤–µ–¥–µ–Ω—ã –∫ –º–∏–Ω–∏–º—É–º—É –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è UX. –í—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **3 —Ç–∏–ø–∞ –¥–∏–∞–ª–æ–≥–æ–≤**:

### 1. –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`load_state_dialog.go`)

**–ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:**
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç `state.json` –∏–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "Read"

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- –ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π:
  - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `state.json`, `my-config.json`)
  - –î–ª—è `state.json` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–µ—Ç–∫–∞ "(Current)"
  - –í—ã—Å–æ—Ç–∞ —Å–ø–∏—Å–∫–∞: ~5 —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
  - **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ListWizardStateNames()` - —á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –±–µ–∑ —á—Ç–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–æ–≤
- –ö–Ω–æ–ø–∫–∏: "Load", "New", "Cancel"
  - "Load" ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∏–ª–∏ `state.json`, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ)
  - "New" ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –Ω–∞—á–∞—Ç—å —Å —à–∞–±–ª–æ–Ω–∞
  - "Cancel" ‚Äî –∑–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞: –µ—Å–ª–∏ –µ—Å—Ç—å `state.json`, –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ"
- –ü—Ä–∏ "Read": –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—Å–º. –Ω–∏–∂–µ)
- –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `bin/wizard_states/`, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –¥–æ –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 2. –î–∏–∞–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (`save_state_dialog.go`)

**–ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:**
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "Save As"
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "Save", –µ—Å–ª–∏ `state.json` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ ID (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ):
  - –í–∞–ª–∏–¥–∞—Ü–∏—è: —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã (a-z, A-Z), —Ü–∏—Ñ—Ä—ã (0-9), –¥–µ—Ñ–∏—Å (-), –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ (_)
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 50 —Å–∏–º–≤–æ–ª–æ–≤
  - –ï—Å–ª–∏ ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –¥–∏–∞–ª–æ–≥–µ: "–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ë—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ."
  - –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ):
  - –¢–µ–∫—Å—Ç–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ö–Ω–æ–ø–∫–∏: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "–û—Ç–º–µ–Ω–∞"

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–∏ "Save" —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `state.json`: –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –≤ `state.json`
- –ü—Ä–∏ "Save As": —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, `state.json` –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è

### 3. –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)

**–ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è:**
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "Read" —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞):
  - –ü—Ä–∏ "Read": "–¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?"
  - –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º?"
- –ö–Ω–æ–ø–∫–∏: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å", "–û—Ç–º–µ–Ω–∞"
  - "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ "Save As" (–¥–ª—è "Read") –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ `state.json` (–¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è)
  - "–ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å" ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ—Ç–µ—Ä—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
  - "–û—Ç–º–µ–Ω–∞" ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é, –æ—Å—Ç–∞—Ç—å—Å—è –≤ –≤–∏–∑–∞—Ä–¥–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–∏ "Read" ‚Üí "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å": –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ "Save As", –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ ‚Üí "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å": —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `state.json` (–µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤)

---

## –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –æ–ø–µ—Ä–∞—Ü–∏–∏ Load/Save –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ (< 100ms –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** —Ñ–∞–π–ª—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –æ–±–ª–∞–∫–æ
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** JSON —Ñ–∞–π–ª—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ—Ç–ª–∞–¥–∫–∏
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ—Ç ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞)
- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –≤ –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏—è 1, –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `ui/wizard/models/wizard_state_file.go` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
  - `WizardStateFile`
  - `PersistedRuleState`
  - `PersistedTemplateSelectableRule`
  - `WizardStateMetadata`
  - –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `ui/wizard/business/state_store.go` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π:
  - `SaveWizardState(state *WizardStateFile) error` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ —Ñ–∞–π–ª
  - `SaveCurrentState(state *WizardStateFile) error` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ `state.json` (—Å –¥–∏–∞–ª–æ–≥–æ–º –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º)
  - `LoadWizardState(id string) (*WizardStateFile, error)` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ ID
  - `LoadCurrentState() (*WizardStateFile, error)` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å `state.json`
  - `ListWizardStates() ([]WizardStateMetadata, error)` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å –ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (—á–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤)
  - `ListWizardStateNames() ([]WizardStateMetadata, error)` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ –±–µ–∑ —á—Ç–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –¥–∏–∞–ª–æ–≥–∞)
  - `DeleteWizardState(id string) error` ‚Äî —É–¥–∞–ª–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
  - `ValidateStateID(id string) error` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è ID
- `ui/wizard/dialogs/load_state_dialog.go` ‚Äî –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è "Read" –∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞)
- `ui/wizard/dialogs/save_state_dialog.go` ‚Äî –¥–∏–∞–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–¥–ª—è "Save As")

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö

#### `ui/wizard/wizard.go`
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ `ShowConfigWizard`:
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `state.json`
  - –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ (–µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
  - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ª–æ–≥–∏–∫—É –∑–∞–≥—Ä—É–∑–∫–∏

#### `ui/wizard/presentation/presenter.go`
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã:
  - `SaveCurrentState() error` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `state.json`
  - `SaveStateAs(comment, id string) error` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥ –Ω–æ–≤—ã–º ID —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
  - `LoadState(stateFile *WizardStateFile) error` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –º–æ–¥–µ–ª—å
  - `CreateStateFromModel(comment, id string) *WizardStateFile` ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
  - `HasUnsavedChanges() bool` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - `MarkAsChanged()` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ SyncGUIToModel, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
- –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
  - –§–ª–∞–≥ `hasChanges bool` –≤ –ø—Ä–µ–∑–µ–Ω—Ç–µ—Ä–µ
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `true` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ `SyncGUIToModel()` (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
  - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ `false` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### `ui/wizard/presentation/gui_state.go`
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ (—Å–ª–µ–≤–∞, –ø–µ—Ä–µ–¥ Close):
  - "Read" ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞
  - "Save" ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ `state.json`
  - "Save As" ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤–Ω–∏–∑—É –≤–∏–∑–∞—Ä–¥–∞:
  - –°–ª–µ–≤–∞: [Read] [Save] [Save As] [Close]
  - –°–ø—Ä–∞–≤–∞: [Prev] [Next] (–∏–ª–∏ [Prev] [Save] –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ç–∞–±–µ Preview, –≥–¥–µ Save ‚Äî —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞)

#### `ui/wizard/wizard.go` (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è)
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –æ–∫–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `hasUnsavedChanges()`
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FileService

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `FileServiceAdapter` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `ExecDir()`
- –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π: `filepath.Join(fileService.ExecDir(), "bin", "wizard_states")`
- –°–æ–∑–¥–∞–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

---

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (Acceptance Criteria)

- [ ] –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞, –µ—Å–ª–∏ –µ—Å—Ç—å `state.json` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Save" (—Å –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Ñ–∞–π–ª–µ)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º —á–µ—Ä–µ–∑ "Save As"
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Read" –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- [ ] –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ "Read" —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- [ ] –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–Ω–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `state.json` –∫–∞–∫ "—Ç–µ–∫—É—â–µ–µ"
- [ ] –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–∑–∞—Ä–¥ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å —Ç–µ–º–∏ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (ParserConfig, URLs, –ø—Ä–∞–≤–∏–ª–∞, –≤—ã–±—Ä–∞–Ω–Ω—ã–µ outbounds)
- [ ] –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- [ ] –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ `config.json`/—à–∞–±–ª–æ–Ω
- [ ] –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ—Ç ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ `config.json`/—à–∞–±–ª–æ–Ω–∞)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è ID —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –º–∞–∫—Å. 50 —Å–∏–º–≤–æ–ª–æ–≤)

---

## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–§–∞–∑–∞ 1: –ú–æ–¥–µ–ª–∏ –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `WizardStateFile`, `PersistedRuleState`, `PersistedTemplateSelectableRule`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é ID —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

2. **–§–∞–∑–∞ 2: –•—Ä–∞–Ω–µ–Ω–∏–µ (StateStore)**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `state_store.go` —Å –º–µ—Ç–æ–¥–∞–º–∏ CRUD
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
   - –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å `state.json` –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
   - –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

3. **–§–∞–∑–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Presenter**
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ –≤ Presenter
   - –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (`hasChanges`)
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

4. **–§–∞–∑–∞ 4: UI - –î–∏–∞–ª–æ–≥–∏**
   - –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`load_state_dialog.go`) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è "Read" –∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞
   - –î–∏–∞–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (`save_state_dialog.go`) ‚Äî –¥–ª—è "Save As"
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

5. **–§–∞–∑–∞ 5: UI - –ö–Ω–æ–ø–∫–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ –≤–∏–∑–∞—Ä–¥ ("Read", "Save", "Save As") ‚Äî —Å–ª–µ–≤–∞, –ø–µ—Ä–µ–¥ Close
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥–∏ —Å –∫–Ω–æ–ø–∫–∞–º–∏
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –≤–∏–∑–∞—Ä–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

6. **–§–∞–∑–∞ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
   - E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI

---

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–∑–∞—Ä–¥–∞ –≤ `state.json` –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–∑–∞—Ä–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –°–Ω–∏–∂–µ–Ω —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤–∏–∑–∞—Ä–¥–æ–º
- –£–ø—Ä–æ—â–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ —á–µ—Ä–µ–∑ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º (–µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ—Ç)
