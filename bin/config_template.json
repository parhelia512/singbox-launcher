{
  // Documentation:
  // https://github.com/Leadaxe/singbox-launcher/blob/main/README.md#configuring-configjson
  
  /** @ParserConfig
    {
      "ParserConfig": {
        "version": 4,
        "proxies": [{ "source": "https://your-subscription-url-here" }],
        "outbounds": [
          {
            "tag": "auto-proxy-out",
            "wizard": {"required": 1},
            "type": "urltest",
            "options": {
              "url": "https://cp.cloudflare.com/generate_204",
              "interval": "5m",
              "tolerance": 100,
              "interrupt_exist_connections": true
            },
            "filters": { "tag": "!/(🇷🇺)/i" },
            "comment": "Proxy automated group for everything that should go through VPN"
          },
          {
            "tag": "proxy-out",
            "wizard": {"required": 1},
            "type": "selector",
            "options": { "interrupt_exist_connections": true, "default": "auto-proxy-out"},
            "filters": { "tag": "!/(🇷🇺)/i" },
            "addOutbounds": ["direct-out","auto-proxy-out"],
            "comment": "Proxy group for everything that should go through VPN"
          },
          {
            "tag": "go-any-way-githubusercontent",
            "wizard": {"hide": true, "required": 2},
            "type": "urltest",
            "options": {
              "url": "https://raw.githubusercontent.com/github/gitignore/main/Global/GPG.gitignore",
              "interval": "1h",
              "idle_timeout": "1h",
              "tolerance": 1000,
              "interrupt_exist_connections": true
            },
            "addOutbounds": ["direct-out"],
            "comment": "find any way"
          }
        ]
      }
    }
  */
  
    // Documentation:
    // https://deepwiki.com/chika0801/sing-box-examples/
    // https://sing-box.sagernet.org/configuration/
  
    // --- LOGGING SETTINGS -----------------------------------------------------
    // Defines log detail level, timestamp inclusion, and file output.
    "log": {
      // trace debug info warn error fatal panic.
      "level": "warn",   // "info" for daily use, "debug" for troubleshooting.
      "timestamp": true  // Add timestamp to each log entry.
     // "output": "singbox.log" // Uncomment to write logs to file.
    },
    // --- DNS CONFIGURATION ----------------------------------------------------
    // Defines how sing-box resolves domain names. Processed from top to bottom.
    "dns": {
      "servers": [
        {
          "type": "udp",
          "tag": "direct_dns_resolver",
          "server": "1.1.1.1",
          "server_port": 53
        },
        {
          "type": "https",
          "tag": "google_doh",
          "server": "8.8.8.8",
          "server_port": 443,
          "path": "/dns-query"
        },
        {
          "type": "https",
          "tag": "google_doh_vpn",
          "server": "8.8.8.8",
          "server_port": 443,
          "path": "/dns-query",
          "detour": "proxy-out"
        },
        {
          "type": "https",
          "tag": "yandex_doh",
          "server": "77.88.8.88",
          "server_port": 443,
          "path": "/dns-query",
          "domain_strategy": "prefer_ipv4"
        },
        {
          "type": "udp",
          "tag": "yandex_dns_vpn",
          "server": "77.88.8.2",
          "server_port": 53,
          "detour": "proxy-out",
          "domain_strategy": "prefer_ipv4"
        },
        {
          "type": "udp",
          "tag": "yandex_dns_direct",
          "server": "77.88.8.2",
          "server_port": 53,
          "domain_strategy": "prefer_ipv4"
        }
      ],
      "rules": [
        { "domain_suffix": ["githubusercontent.com", "github.com"], "server": "direct_dns_resolver" },
        { "rule_set": "ru-domains", "server": "yandex_doh" },
        { "rule_set": "ru-domains", "server": "yandex_dns_vpn" },
        { "rule_set": "ru-domains", "server": "yandex_dns_direct" },
        { "server": "google_doh" },
        { "server": "google_doh_vpn" }
      ],
      "final": "direct_dns_resolver",
      "strategy": "ipv4_only",
      "independent_cache": false
    },
  
    // --- INCOMING CONNECTIONS (INBOUNDS) -------------------------------------
    "inbounds": [
    // TUN Интерфейс: для прозрачного проксирования всего системного трафика (работает как VPN).
      {
        "type": "tun",
        "tag": "tun-in",
        "interface_name": "singbox-tun0", // Имя виртуального сетевого адаптера, создаваемого Sing-box.
        "address": [                      // Используйте диапазон, который не пересекается с вашей реальной LAN.
          "172.16.0.1/30"                 // Внутренний IPv4 адрес для TUN-интерфейса.
        ],
        "mtu": 1492,                      // Максимальный размер передаваемого блока (стандартное значение для Ethernet).
        "auto_route": true,               // Автоматически добавлять/удалять маршруты в системную таблицу маршрутизации.
        "strict_route": false,            // На Windows: принудительно направлять весь трафик через TUN, помогает предотвратить утечки DNS.
        "route_exclude_address": [
          "10.0.0.0/8",          // LAN: WG / другие VPN
          "172.16.0.0/12",       // LAN: TUN sing-box
          "192.168.0.0/16",      // LAN
          "127.0.0.0/8",         // loopback
          "169.254.0.0/16",      // link-local
          "100.64.0.0/10",       // CGNAT (опционально)
          "224.0.0.0/4",         // IPv4 multicast (mDNS, IGMP и т.д.)
          "255.255.255.255/32",  // broadcast
          "198.18.0.0/15",       // тестовый диапазон (опционально)
          "fc00::/7",            // IPv6 unique local
          "fe80::/10",           // IPv6 link-local
          "ff00::/8",            // IPv6 multicast
          "::1/128"              // IPv6 loopback
        ],
        "stack": "system"                // Использовать гибридный стек TCP/IP для обработки трафика на TUN интерфейсе.
                                        // TCP - внутренний стек Sing-box, UDP - системный стек.
        // Объект "platform" для Windows-специфичных настроек tun, таких как http_proxy,
        // не поддерживается напрямую в этом контексте и удален.
      }
    ],
    // --- OUTGOING CONNECTIONS (OUTBOUNDS) ------------------------------------
    "outbounds": [
      /** @PARSER_OUTBOUNDS_BLOCK */
      { "type": "direct", "tag": "direct-out" }
    ],
    // --- ROUTING RULES -------------------------------------------------------
    "route": {
      "default_domain_resolver": "direct_dns_resolver",
      "rule_set": [
        { "tag": "ru-domains", "type": "inline", "format": "domain_suffix", "rules": [{ "domain_suffix": ["ru", "xn--p1ai", "su"] }] },
        { "tag": "ads-all", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geosite/geosite-category-ads-all.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "ru-inside", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geosite/geosite-ru-available-only-inside.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "ru-blocked-main", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geoip/geoip-ru-blocked.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "ru-blocked-community", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geoip/geoip-ru-blocked-community.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "israel-sites", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geoip/geoip-il.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "games", "type": "remote", "format": "binary", "url": "https://raw.githubusercontent.com/runetfreedom/russia-v2ray-rules-dat/release/sing-box/rule-set-geosite/geosite-category-games.srs", "download_detour": "go-any-way-githubusercontent", "update_interval": "24h" },
        { "tag": "messengers", "type": "inline", "format": "domain_suffix", "rules": [{ "domain_suffix": ["meet.google.com", "googlevideo.com", "gstatic.com", "googleusercontent.com", "googleapis.com", "web.whatsapp.com", "whatsapp.com", "whatsapp.net", "cdn.whatsapp.net", "mmg.whatsapp.net", "discord.com", "discordapp.com", "cdn.discordapp.com", "discord.gg", "gateway.discord.gg", "discord.media", "telegram.org", "t.me", "cdn-telegram.org"] }, { "process_name": ["Telegram.exe", "Discord.exe", "WhatsApp.exe", "Signal.exe", "Zoom.exe"] }] },
        { "tag": "gemini", "type": "inline", "format": "domain_suffix", "rules": [{ "domain_suffix": ["generativelanguage.googleapis.com", "gemini.google.com", "ai.google.dev", "palm.googleapis.com"] }] }
      ],
      "rules": [
        { "inbound": "tun-in", "action": "resolve", "strategy": "prefer_ipv4" },
        { "inbound": "tun-in", "action": "sniff", "timeout": "1s" },
        { "protocol": "dns", "action": "hijack-dns" },
        { "ip_is_private": true, "outbound": "direct-out" },
        { "domain_suffix": ["local", "lan"], "outbound": "direct-out" }
  /**   @SelectableRule
        @label Block Ads (ads-all, soft)
        @default
        @description Soft-block ads by rejecting connections instead of dropping packets
        {"rule_set": "ads-all", "action": "reject"},
  */
  /**   @SelectableRule
        @label Russian domains direct
        @description Route Russian domains
        { "rule_set": "ru-domains", "outbound": "direct-out" },
  */
  /**   @SelectableRule
        @label Russia-only services
        @description Use Russian VPN group for services available only inside Russia.
        { "rule_set": "ru-inside", "outbound": "direct-out" },
  */
  /**   @SelectableRule
        @label Russian blocked resources
        @description Detour resources blocked in Russia through proxy selector.
        { "rule_set": ["ru-blocked-main", "ru-blocked-community"], "network": ["tcp", "udp"], "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label Israel-specific sites
        @description Send Israel-focused traffic via main proxy selector.
        { "rule_set": "israel-sites", "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label Drop RU DNS over UDP
        @description Block UDP DNS queries that target Russian domains.
        { "rule_set": "ru-domains", "action": "reject", "method": "drop", "network": ["udp"], "port": [53] },
  */
  /**   @SelectableRule
        @label BitTorrent direct
        @default
        @description Route BitTorrent traffic directly to avoid VPN throttling.
        { "protocol": ["bittorrent"], "outbound": "direct-out" },
  */
  /**   @SelectableRule
        @label 2ip.io for VPN IP test
        @default
        @description Direct route for 2ip.io to check VPN IP.
        { "domain": ["2ip.io"], "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label 2ip.me via proxy
        @description Route 2ip.me through proxy to verify VPN IP.
        { "domain": ["2ip.me"], "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label 2ip.ru your direct ip test
        @default
        @description Direct route for 2ip.ru to check your IP.
        { "domain": ["2ip.ru"], "outbound": "direct-out" },
  */
  /**   @SelectableRule
        @label Gemini via Gemini VPN
        @description Use dedicated Gemini VPN selector for Gemini rule set.
        { "rule_set": "gemini", "network": ["tcp", "udp"], "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label Messengers via proxy
        @default
        @description Send messenger traffic through proxy selector.
        { "rule_set": "messengers", "network": ["tcp", "udp"], "outbound": "proxy-out" },
  */
  /**   @SelectableRule
        @label Games direct
        @default
        @description Send gaming rule set traffic directly for lower latency.
        { "rule_set": "games", "network": ["tcp", "udp"], "outbound": "direct-out" },
  */
  /**   @SelectableRule
        @label Gaming ports direct
        @default
        @description Keep popular gaming ports and Steam ranges outside VPN.
        {
          "port": [3659, 1935, 5001, 5795, 5796, 7000, 7777, 9000, 10039, 10040],
          "port_range": "27000:27100",
          "network": ["tcp", "udp"],
          "outbound": "direct-out"
        },
  */
  /**   @SelectableRule
        @label stop HTTP/3

        @description QUIC does not support UDP traffic proxying. Therefore, we stop HTTP/3. This may block QUIC traffic (used by Google, YouTube, Cloudflare, etc.), which may potentially reduce speed or availability for these services.
        { "action": "reject", "method": "drop", "network": ["udp"], "port": [443] },
  */
      ],
      "final": "proxy-out",
      "auto_detect_interface": true
    },
    "experimental": {
      "clash_api": {
        "external_controller": "127.0.0.1:9090",
        "secret": "CHANGE_THIS_TO_YOUR_SECRET_TOKEN"
      },
      "cache_file": {
        "enabled": true,          // Обязательно — включает кеш для remote rule-set (и FakeIP, если используешь)
        "path": "cache.db"        // Опционально: имя файла (по умолчанию cache.db)
      }
    }
  }
  
  
